{"ast":null,"code":"import _asyncToGenerator from \"/Users/migueload/inspectionSquad/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Camera, CameraResultType } from '@capacitor/camera';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"../services/service.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/router\";\nfunction ObservationResumePage_ion_label_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-label\")(1, \"b\");\n    i0.ɵɵelement(2, \"ion-icon\", 6);\n    i0.ɵɵtext(3, \" Sub Observation\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.observation_child, \" \");\n  }\n}\nconst _c0 = a1 => [\"/detail-photo\", a1];\nfunction ObservationResumePage_ion_row_57_ng_container_1_ion_img_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-img\", 27);\n  }\n  if (rf & 2) {\n    const photo_r2 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵpropertyInterpolate1(\"src\", \"data:image/png;base64,\", photo_r2.url_image, \"\");\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(2, _c0, photo_r2.url_image));\n  }\n}\nfunction ObservationResumePage_ion_row_57_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-col\", 23)(2, \"div\", 24)(3, \"ion-icon\", 25);\n    i0.ɵɵlistener(\"click\", function ObservationResumePage_ion_row_57_ng_container_1_Template_ion_icon_click_3_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const photo_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.showConfirmation(photo_r2.id));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(4, ObservationResumePage_ion_row_57_ng_container_1_ion_img_4_Template, 1, 4, \"ion-img\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const photo_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", photo_r2.url_image);\n  }\n}\nfunction ObservationResumePage_ion_row_57_ng_container_2_ion_img_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-img\", 29);\n  }\n  if (rf & 2) {\n    const photo_r2 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵpropertyInterpolate1(\"src\", \"data:image/png;base64,\", photo_r2.url_image, \"\");\n  }\n}\nfunction ObservationResumePage_ion_row_57_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-col\", 23)(2, \"div\", 24)(3, \"ion-icon\", 25);\n    i0.ɵɵlistener(\"click\", function ObservationResumePage_ion_row_57_ng_container_2_Template_ion_icon_click_3_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const photo_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.showConfirmation(photo_r2.id));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(4, ObservationResumePage_ion_row_57_ng_container_2_ion_img_4_Template, 1, 1, \"ion-img\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const photo_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", photo_r2.url_image);\n  }\n}\nfunction ObservationResumePage_ion_row_57_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-row\");\n    i0.ɵɵtemplate(1, ObservationResumePage_ion_row_57_ng_container_1_Template, 5, 1, \"ng-container\", 7)(2, ObservationResumePage_ion_row_57_ng_container_2_Template, 5, 1, \"ng-container\", 7);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r3 = ctx.index;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", i_r3 % 2 === 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", i_r3 % 2 !== 0);\n  }\n}\nconst _c1 = a1 => [\"/observation-section\", a1];\nexport let ObservationResumePage = /*#__PURE__*/(() => {\n  class ObservationResumePage {\n    constructor(navCtrl, actionSheetCtrl, alert, service, toast, loadingController) {\n      this.navCtrl = navCtrl;\n      this.actionSheetCtrl = actionSheetCtrl;\n      this.alert = alert;\n      this.service = service;\n      this.toast = toast;\n      this.loadingController = loadingController;\n      this.isAlertOpen = false;\n      this.alertButtons = ['Action'];\n      this.isRefrescar = false;\n    }\n    ngOnInit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        _this.initialItems();\n        _this.getPhotos();\n        _this.refreshPage();\n      })();\n    }\n    initialItems() {\n      console.log(\"ok\");\n      this.user = localStorage.getItem(\"username\");\n      this.name_emp = localStorage.getItem(\"name_emp\");\n      this.date = localStorage.getItem(\"date\");\n      this.address_emp = localStorage.getItem(\"address_emp\");\n      this.observation_section = localStorage.getItem(\"observation_section\");\n      this.observation = localStorage.getItem(\"observation\");\n      this.observation_child = localStorage.getItem(\"observation_child\");\n      this.comments = localStorage.getItem(\"comments\");\n      this.type_inspection = localStorage.getItem('type_inspection');\n    }\n    closeSesion() {\n      localStorage.clear();\n      this.navCtrl.navigateForward('');\n    }\n    refreshPage() {\n      this.ionViewWillEnter();\n    }\n    ionViewWillEnter() {\n      if (this.isRefrescar) {\n        document.location.reload();\n        this.isRefrescar = false;\n      }\n    }\n    presentActionSheet() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        const actionSheet = yield _this2.actionSheetCtrl.create({\n          header: 'Actions',\n          buttons: [{\n            text: 'Are you sure you log out?',\n            role: 'exit',\n            handler: () => {\n              _this2.closeSesion();\n            }\n          }, {\n            text: 'Cancel',\n            role: 'cancel',\n            data: {\n              action: 'cancel'\n            }\n          }]\n        });\n        yield actionSheet.present();\n      })();\n    }\n    showConfirmation(id) {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        const alert = yield _this3.alert.create({\n          header: 'Confirmation',\n          message: '¿Are you sure?',\n          buttons: [{\n            text: 'Cancel',\n            role: 'cancel',\n            cssClass: 'secondary',\n            handler: () => {\n              console.log('Acción cancelada');\n            }\n          }, {\n            text: 'Ok',\n            handler: () => {\n              _this3.delPhoto(id);\n            }\n          }]\n        });\n        yield alert.present();\n      })();\n    }\n    getPhotos() {\n      const dato = {\n        \"id_observation\": localStorage.getItem('id_observation')\n      };\n      this.service.getPhotos(dato).subscribe(respuesta => {\n        this.photos = respuesta;\n      }, error => {\n        console.log(\"Error\" + error);\n      });\n    }\n    delPhoto(id) {\n      const datosPhoto = {\n        'id': id\n      };\n      this.service.delPhoto(datosPhoto).subscribe(respuesta => {\n        this.getPhotos();\n      }, error => {\n        console.log(\"Error\" + error);\n      });\n    }\n    generateReport(isOpen) {\n      const id = localStorage.getItem(\"id_assigment\");\n      this.service.generateReport(id).subscribe(respuesta => {\n        this.isAlertOpen = isOpen;\n      }, error => {\n        console.log(\"Error\" + error);\n      });\n    }\n    takePhoto() {\n      var _this4 = this;\n      return _asyncToGenerator(function* () {\n        const image = yield Camera.getPhoto({\n          quality: 60,\n          allowEditing: false,\n          resultType: CameraResultType.Base64\n        });\n        _this4.saveImage(image.base64String);\n        _this4.ngOnInit();\n      })();\n    }\n    saveImage(image) {\n      var _this5 = this;\n      return _asyncToGenerator(function* () {\n        // Mostrar el spinner de carga\n        const loading = yield _this5.loadingController.create({\n          message: 'Saving image...'\n        });\n        yield loading.present();\n        const id_inspection = localStorage.getItem(\"id_inspection\");\n        const id_observation = localStorage.getItem(\"id_observation\");\n        const datosInspectionImage = {\n          \"id_inspection\": id_inspection,\n          \"id_observation\": id_observation,\n          \"url_image\": image\n        };\n        _this5.service.saveImage(datosInspectionImage).subscribe(respuesta => {\n          loading.dismiss();\n          _this5.success();\n          _this5.getPhotos();\n        }, error => {\n          loading.dismiss();\n          console.log(\"Error\" + error);\n        });\n      })();\n    }\n    success() {\n      var _this6 = this;\n      return _asyncToGenerator(function* () {\n        const toast = yield _this6.toast.create({\n          message: 'The photo has been saved.',\n          duration: 3000,\n          position: 'middle'\n        });\n        toast.present();\n      })();\n    }\n    static #_ = this.ɵfac = function ObservationResumePage_Factory(t) {\n      return new (t || ObservationResumePage)(i0.ɵɵdirectiveInject(i1.NavController), i0.ɵɵdirectiveInject(i1.ActionSheetController), i0.ɵɵdirectiveInject(i1.AlertController), i0.ɵɵdirectiveInject(i2.ServiceService), i0.ɵɵdirectiveInject(i1.ToastController), i0.ɵɵdirectiveInject(i1.LoadingController));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ObservationResumePage,\n      selectors: [[\"app-observation-resume\"]],\n      decls: 74,\n      vars: 16,\n      consts: [[3, \"translucent\"], [\"src\", \"../../assets/img/logo_circle.png\", \"alt\", \"Logo Inspection squad\", 2, \"width\", \"50px\"], [1, \"user\", 2, \"text-align\", \"right\", 3, \"click\"], [2, \"color\", \"#6E6E6E\"], [\"name\", \"person\"], [1, \"titulo\"], [\"name\", \"checkmark-outline\"], [4, \"ngIf\"], [\"value\", \"first\"], [\"slot\", \"header\", \"color\", \"light\"], [\"name\", \"chatbubble-ellipses-outline\"], [\"slot\", \"content\", 1, \"ion-padding\"], [4, \"ngFor\", \"ngForOf\"], [2, \"margin-left\", \"20px\", \"padding-right\", \"20px\", \"margin-bottom\", \"20px\"], [\"color\", \"medium\", \"expand\", \"full\", 3, \"click\"], [\"name\", \"camera-outline\"], [\"fill\", \"clear\", \"expand\", \"full\", 2, \"background-color\", \"#1c345c\", \"color\", \"#fff\", 3, \"routerLink\"], [\"name\", \"add-outline\"], [\"fill\", \"clear\", \"expand\", \"full\", 2, \"background-color\", \"#1c345c\", \"color\", \"#fff\", 3, \"click\"], [\"name\", \"document-outline\"], [\"header\", \"Send Report\", \"message\", \"The report has been sent successfully.\", 3, \"isOpen\", \"subHeader\", \"buttons\", \"didDismiss\"], [\"fill\", \"clear\", \"expand\", \"full\", \"routerLink\", \"../dashboard\", 2, \"background-color\", \"#fff\", \"color\", \"#000\"], [\"name\", \"chevron-back-outline\"], [\"size\", \"6\"], [2, \"text-align\", \"left\"], [\"name\", \"close-circle-outline\", 2, \"color\", \"#b11c44\", \"font-size\", \"22px\", 3, \"click\"], [3, \"src\", \"routerLink\", 4, \"ngIf\"], [3, \"src\", \"routerLink\"], [3, \"src\", 4, \"ngIf\"], [3, \"src\"]],\n      template: function ObservationResumePage_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\");\n          i0.ɵɵelement(2, \"ion-img\", 1);\n          i0.ɵɵelementStart(3, \"div\", 2);\n          i0.ɵɵlistener(\"click\", function ObservationResumePage_Template_div_click_3_listener() {\n            return ctx.presentActionSheet();\n          });\n          i0.ɵɵelementStart(4, \"ion-label\", 3);\n          i0.ɵɵtext(5);\n          i0.ɵɵelement(6, \"ion-icon\", 4);\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(7, \"ion-content\")(8, \"ion-card\")(9, \"ion-card-content\")(10, \"ion-label\")(11, \"b\");\n          i0.ɵɵtext(12, \"Establishment Name:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(13);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(14, \"br\");\n          i0.ɵɵelementStart(15, \"ion-label\")(16, \"b\");\n          i0.ɵɵtext(17, \"Date:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(18);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(19, \"br\");\n          i0.ɵɵelementStart(20, \"ion-label\")(21, \"b\");\n          i0.ɵɵtext(22, \"Establishment Address:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(23);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(24, \"br\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelement(25, \"br\");\n          i0.ɵɵelementStart(26, \"ion-item\")(27, \"ion-label\", 5);\n          i0.ɵɵtext(28, \"SUMMARY OF INSPECTION OBSERVATIONS \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(29, \"ion-card\")(30, \"ion-card-content\")(31, \"ion-label\")(32, \"b\");\n          i0.ɵɵtext(33, \"Section Observation\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(34);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(35, \"br\")(36, \"br\");\n          i0.ɵɵelementStart(37, \"ion-label\")(38, \"b\");\n          i0.ɵɵelement(39, \"ion-icon\", 6);\n          i0.ɵɵtext(40, \" Observation\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(41);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(42, \"br\");\n          i0.ɵɵtemplate(43, ObservationResumePage_ion_label_43_Template, 5, 1, \"ion-label\", 7);\n          i0.ɵɵelement(44, \"br\")(45, \"br\");\n          i0.ɵɵelementStart(46, \"ion-accordion-group\")(47, \"ion-accordion\", 8)(48, \"ion-item\", 9)(49, \"ion-label\");\n          i0.ɵɵelement(50, \"ion-icon\", 10);\n          i0.ɵɵtext(51, \" Comments\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(52, \"div\", 11);\n          i0.ɵɵtext(53);\n          i0.ɵɵelementEnd()()()()();\n          i0.ɵɵelementStart(54, \"ion-card\")(55, \"ion-card-content\")(56, \"ion-grid\");\n          i0.ɵɵtemplate(57, ObservationResumePage_ion_row_57_Template, 3, 2, \"ion-row\", 12);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(58, \"div\", 13)(59, \"ion-button\", 14);\n          i0.ɵɵlistener(\"click\", function ObservationResumePage_Template_ion_button_click_59_listener() {\n            return ctx.takePhoto();\n          });\n          i0.ɵɵelement(60, \"ion-icon\", 15);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(61, \"div\", 13)(62, \"ion-button\", 16);\n          i0.ɵɵelement(63, \"ion-icon\", 17);\n          i0.ɵɵtext(64, \"Add\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(65, \"div\", 13)(66, \"ion-button\", 18);\n          i0.ɵɵlistener(\"click\", function ObservationResumePage_Template_ion_button_click_66_listener() {\n            return ctx.generateReport(true);\n          });\n          i0.ɵɵelement(67, \"ion-icon\", 19);\n          i0.ɵɵtext(68, \"Send Report\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(69, \"ion-alert\", 20);\n          i0.ɵɵlistener(\"didDismiss\", function ObservationResumePage_Template_ion_alert_didDismiss_69_listener() {\n            return ctx.generateReport(false);\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(70, \"footer\")(71, \"ion-button\", 21);\n          i0.ɵɵelement(72, \"ion-icon\", 22);\n          i0.ɵɵtext(73, \"Back\");\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵproperty(\"translucent\", true);\n          i0.ɵɵadvance(5);\n          i0.ɵɵtextInterpolate1(\"\", ctx.user, \" \");\n          i0.ɵɵadvance(8);\n          i0.ɵɵtextInterpolate1(\" \", ctx.name_emp, \"\");\n          i0.ɵɵadvance(5);\n          i0.ɵɵtextInterpolate1(\" \", ctx.date, \"\");\n          i0.ɵɵadvance(5);\n          i0.ɵɵtextInterpolate1(\" \", ctx.address_emp, \"\");\n          i0.ɵɵadvance(11);\n          i0.ɵɵtextInterpolate1(\" \", ctx.observation_section, \"\");\n          i0.ɵɵadvance(7);\n          i0.ɵɵtextInterpolate1(\" \", ctx.observation, \"\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.observation_child);\n          i0.ɵɵadvance(10);\n          i0.ɵɵtextInterpolate1(\" \", ctx.comments, \" \");\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngForOf\", ctx.photos);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(14, _c1, ctx.type_inspection));\n          i0.ɵɵadvance(7);\n          i0.ɵɵpropertyInterpolate(\"subHeader\", ctx.name_emp);\n          i0.ɵɵproperty(\"isOpen\", ctx.isAlertOpen)(\"buttons\", ctx.alertButtons);\n        }\n      },\n      dependencies: [i3.NgForOf, i3.NgIf, i1.IonAccordion, i1.IonAccordionGroup, i1.IonAlert, i1.IonButton, i1.IonCard, i1.IonCardContent, i1.IonCol, i1.IonContent, i1.IonGrid, i1.IonHeader, i1.IonIcon, i1.IonImg, i1.IonItem, i1.IonLabel, i1.IonRow, i1.IonToolbar, i1.RouterLinkDelegate, i4.RouterLink],\n      styles: [\".titulo[_ngcontent-%COMP%]{color:#1c345c}ion-img[_ngcontent-%COMP%]{width:70%;height:auto}\"]\n    });\n  }\n  return ObservationResumePage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}