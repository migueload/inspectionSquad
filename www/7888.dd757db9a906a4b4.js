"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7888],{7888:(w,A,p)=>{p.r(A),p.d(A,{AssingPageModule:()=>k});var c=p(6814),v=p(95),o=p(1929),h=p(1147),g=p(5861),I=p(5619),t=p(9212),s=p(3378),x=p(7346);const P=["addressSelect"];function M(i,l){if(1&i&&(t.TgZ(0,"ion-select-option",24),t._uU(1),t.qZA()),2&i){const a=l.$implicit;t.s9C("value",a.code),t.xp6(1),t.hij(" ",a.description," ")}}function E(i,l){if(1&i&&(t.TgZ(0,"ion-select-option",24),t._uU(1),t.qZA()),2&i){const a=l.$implicit;t.s9C("value",a.id),t.xp6(1),t.AsE(" ",a.name," ",a.last_name," ")}}function U(i,l){if(1&i&&(t.TgZ(0,"ion-item")(1,"ion-select",25),t.YNc(2,E,2,3,"ion-select-option",9),t.qZA()()),2&i){const a=t.oxw();t.xp6(2),t.Q6J("ngForOf",a.inspectors)}}function j(i,l){if(1&i){const a=t.EpF();t.TgZ(0,"ion-item",27),t.NdJ("click",function(){const r=t.CHM(a).$implicit,d=t.oxw(2);return t.KtG(d.setAddress(r))}),t._UZ(1,"ion-icon",28),t.TgZ(2,"ion-label"),t._uU(3),t.TgZ(4,"p")(5,"ion-text"),t._uU(6),t.qZA()()()()}if(2&i){const a=l.$implicit;t.xp6(3),t.hij(" ",null==a?null:a.title," "),t.xp6(3),t.hij(" ",null==a?null:a.address," ")}}function B(i,l){if(1&i&&(t.TgZ(0,"ion-list"),t.YNc(1,j,7,2,"ion-item",26),t.qZA()),2&i){const a=t.oxw();t.xp6(1),t.Q6J("ngForOf",a.places)}}function F(i,l){if(1&i){const a=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-card")(3,"div",29)(4,"ion-icon",30),t.NdJ("click",function(){const r=t.CHM(a).$implicit,d=t.oxw();return t.KtG(d.showConfirmation(r.id))}),t.qZA()(),t.TgZ(5,"ion-card-header")(6,"ion-card-subtitle")(7,"b"),t._uU(8,"Date:"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"ion-card-subtitle"),t._uU(11),t.qZA(),t.TgZ(12,"ion-card-title"),t._uU(13),t.qZA()(),t.TgZ(14,"ion-card-content"),t._uU(15),t.qZA()()()()}if(2&i){const a=l.$implicit;t.xp6(9),t.hij(" ",a.date,""),t.xp6(2),t.AsE("",a.id_inspection," - ",a.description_inspection,""),t.xp6(2),t.Oqu(a.name_emp),t.xp6(2),t.hij(" ",a.address_emp," ")}}let b=(()=>{var i;class l{get search_places(){return this._places.asObservable()}constructor(e,n,r,d,m,u){this.service=e,this.zone=n,this.alert=r,this.toast=d,this.navCtrl=m,this.actionSheetCtrl=u,this.places=[],this._places=new I.X([]),this.swAdmin=!1,this.isActionSheetOpen=!1}ngOnInit(){this.user=localStorage.getItem("username"),this.nivel=localStorage.getItem("nivel"),this.swAdmin="1"==this.nivel,this.loadTypeInspection(),this.loadInspectors(),"1"==this.nivel?this.loadAssigmentAll():this.loadAssigment(),this.placesSub=this.search_places.subscribe({next:e=>{this.places=e},error:e=>{console.log(e)}})}loadAssigment(){const n={id:localStorage.getItem("id_inspector")};this.service.getAssigmentById(n).subscribe(r=>{this.datos=r,console.log(this.datos)},r=>{console.error("Error al obtener los datos",r)})}loadAssigmentAll(){this.service.getAsignmentAll().subscribe(e=>{this.datos=e},e=>{console.error("Error al obtener los datos",e)})}loadTypeInspection(){this.service.getInspectionstAll().subscribe(e=>{this.types=e},e=>{console.log("Error"+e)})}loadInspectors(){this.service.getInspectors().subscribe(e=>{this.inspectors=e},e=>{console.log("Error"+e)})}onSearchChange(e){var n=this;return(0,g.Z)(function*(){console.log(e),n.query=e.detail.value,n.query.length>0&&(yield n.getPlaces())})()}getPlaces(){var e=this;return(0,g.Z)(function*(){try{(new google.maps.places.AutocompleteService).getPlacePredictions({input:e.query},r=>{let d=[];e.zone.run(()=>{null!=r&&(r.forEach(function(){var m=(0,g.Z)(function*(u){console.log("prediction: ",u);let f=yield e.geoCode(u.description);d.push({title:u.structured_formatting.main_text,address:u.description,lat:f.lat,lng:f.lng})});return function(u){return m.apply(this,arguments)}}()),e._places.next(d))})})}catch(n){console.log(n)}})()}geoCode(e){let n={lat:"",lng:""};return new Promise((r,d)=>{(new google.maps.Geocoder).geocode({address:e},u=>{console.log("results: ",u),n.lat=u[0].geometry.location.lat(),n.lng=u[0].geometry.location.lng(),r(n)})})}ngOnDestroy(){this.placesSub&&this.placesSub.unsubscribe()}setAddress(e){this.addressSelect.nativeElement.value=e.address,this.places=[]}save(){const e=document.getElementById("name"),n=document.getElementById("date"),r=document.getElementById("type"),d=document.getElementById("idiom"),m=document.getElementById("address"),u=document.getElementById("inspector"),f=d.value,y=n.value,T=e.value,C=r.value,N=m.value;let Z=localStorage.getItem("id_inspector");this.swAdmin&&(Z=u.value,localStorage.setItem("id_inspector",Z));let _="";if(""==y&&(_="Date, "),""==T&&(_+="Establishment name, "),null==C&&(_+="Type of inspection, "),this.campos=_,""!=_)this.validarVacio();else{const S={date:y,idiom:f,name_emp:T,address_emp:N,id_inspector:Z,id_inspection:C};console.log(S),this.service.saveAssing(S).subscribe(O=>{this.clearFields(),this.success(),"1"==this.nivel?this.loadAssigmentAll():this.loadAssigment()},O=>{console.log("Error"+O)})}}clearFields(){const e=document.getElementById("name"),n=document.getElementById("date"),r=document.getElementById("type");document.getElementById("address").value="",e.value="",r.value="",n.value=""}back(){this.navCtrl.navigateForward("dashboard")}showConfirmation(e){var n=this;return(0,g.Z)(function*(){yield(yield n.alert.create({header:"Confirmation",message:"\xbfAre you sure?",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Acci\xf3n cancelada")}},{text:"Ok",handler:()=>{n.delAssing(e)}}]})).present()})()}delAssing(e){this.service.delAssing({id:e}).subscribe(r=>{this.loadAssigment()},r=>{console.log("Error"+r)})}closeSesion(){localStorage.clear(),this.navCtrl.navigateForward("")}validarVacio(){var e=this;return(0,g.Z)(function*(){(yield e.toast.create({message:"("+e.campos+") Fields are required",duration:3e3,position:"middle"})).present()})()}success(){var e=this;return(0,g.Z)(function*(){(yield e.toast.create({message:"The assignment was saved successfully.",duration:3e3,position:"middle"})).present()})()}delete(){var e=this;return(0,g.Z)(function*(){(yield e.toast.create({message:"The assignment has been removed.",duration:2e3,position:"middle"})).present()})()}presentActionSheet(){var e=this;return(0,g.Z)(function*(){yield(yield e.actionSheetCtrl.create({header:"Actions",buttons:[{text:"Are you sure you log out?",role:"exit",handler:()=>{e.closeSesion()}},{text:"Cancel",role:"cancel",data:{action:"cancel"}}]})).present()})()}}return(i=l).\u0275fac=function(e){return new(e||i)(t.Y36(s.m),t.Y36(t.R0b),t.Y36(o.Br),t.Y36(o.yF),t.Y36(x.SH),t.Y36(o.BX))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-assing"]],viewQuery:function(e,n){if(1&e&&t.Gf(P,5),2&e){let r;t.iGM(r=t.CRH())&&(n.addressSelect=r.first)}},standalone:!0,features:[t.jDz],decls:53,vars:6,consts:[[3,"translucent"],["src","../../assets/img/logo_circle.png","alt","Logo Inspection squad",2,"width","50px"],[1,"user",2,"text-align","right",3,"click"],[2,"color","#6E6E6E"],["name","person"],[2,"text-align","left","margin-left","20px"],[1,"titulo"],["type","date","id","date","label","Select Date"],["label","Select type of inspection","id","type"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["value","spa","id","idiom"],["value","spa"],["value","eng"],["label","Establishment Name","id","name"],["type","text","id","address","placeholder","Establishment Address","disabled","",2,"background-color","#fff","color","#6E6E6E","width","100%","height","35px"],["addressSelect",""],["searchIcon","search-circle","animated","true","showClearButton","focus","clearIcon","trash-bin","debounce","800","placeholder","Search for area, street...",3,"ionInput"],[2,"margin-top","50px","margin-left","20px","padding-right","20px","margin-bottom","20px"],["fill","clear","expand","full",2,"background-color","#1c345c","color","#fff",3,"click"],["name","checkmark-outline"],[4,"ngFor","ngForOf"],["fill","default","expand","full",2,"background-color","#fff","color","#000",3,"click"],["name","chevron-back-outline"],[3,"value"],["label","Select inspectors","id","inspector"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["name","location-outline","slot","start"],[2,"text-align","right"],["name","close-circle-outline",2,"color","#b11c44","font-size","18px",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar"),t._UZ(2,"ion-img",1),t.TgZ(3,"div",2),t.NdJ("click",function(){return n.presentActionSheet()}),t.TgZ(4,"ion-label",3),t._uU(5),t._UZ(6,"ion-icon",4),t.qZA()()()(),t.TgZ(7,"ion-content"),t._UZ(8,"br"),t.TgZ(9,"div",5)(10,"ion-label",6),t._uU(11,"ASSING"),t.qZA()(),t._UZ(12,"br"),t.TgZ(13,"ion-list")(14,"ion-item"),t._UZ(15,"ion-input",7),t.qZA(),t._UZ(16,"br"),t.TgZ(17,"ion-item")(18,"ion-select",8),t.YNc(19,M,2,2,"ion-select-option",9),t.qZA()(),t._UZ(20,"br"),t.YNc(21,U,3,1,"ion-item",10),t._UZ(22,"br"),t.TgZ(23,"ion-item")(24,"ion-label"),t._uU(25," Select the language of the inspection report "),t.qZA(),t.TgZ(26,"ion-segment",11)(27,"ion-segment-button",12)(28,"ion-label"),t._uU(29,"Spanish"),t.qZA()(),t.TgZ(30,"ion-segment-button",13)(31,"ion-label"),t._uU(32,"English"),t.qZA()()()(),t._UZ(33,"br"),t.TgZ(34,"ion-item"),t._UZ(35,"ion-input",14),t.qZA(),t.TgZ(36,"ion-item"),t._UZ(37,"input",15,16),t.qZA(),t._UZ(39,"br"),t.TgZ(40,"ion-item")(41,"ion-searchbar",17),t.NdJ("ionInput",function(d){return n.onSearchChange(d)}),t.qZA()()(),t.YNc(42,B,2,1,"ion-list",10),t.TgZ(43,"div",18)(44,"ion-button",19),t.NdJ("click",function(){return n.save()}),t._UZ(45,"ion-icon",20),t._uU(46,"Save"),t.qZA()(),t.TgZ(47,"ion-grid"),t.YNc(48,F,16,5,"ion-row",21),t.qZA()(),t.TgZ(49,"ion-footer")(50,"ion-button",22),t.NdJ("click",function(){return n.back()}),t._UZ(51,"ion-icon",23),t._uU(52,"Back"),t.qZA()()),2&e&&(t.Q6J("translucent",!0),t.xp6(5),t.hij("",n.user," "),t.xp6(14),t.Q6J("ngForOf",n.types),t.xp6(2),t.Q6J("ngIf",n.swAdmin),t.xp6(21),t.Q6J("ngIf",(null==n.places?null:n.places.length)>0),t.xp6(6),t.Q6J("ngForOf",n.datos))},dependencies:[o.Pc,o.YG,o.PM,o.FN,o.Zi,o.tO,o.Dq,o.wI,o.W2,o.fr,o.jY,o.Gu,o.gu,o.Xz,o.pK,o.Ie,o.Q$,o.q_,o.Nd,o.VI,o.cJ,o.GO,o.t9,o.n0,o.yW,o.sr,o.QI,o.j9,c.ez,c.sg,c.O5],styles:[".ios[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{padding:8px 12px}.ios[_ngcontent-%COMP%]   #address[_ngcontent-%COMP%]{width:100%;border-color:solid;border-style:none}ion-card-title[_ngcontent-%COMP%]{font-size:20px}"]}),l})();const W=[{path:"",component:b}];let q=(()=>{var i;class l{}return(i=l).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.Bz.forChild(W),h.Bz]}),l})(),k=(()=>{var i;class l{}return(i=l).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[c.ez,v.u5,o.Pc,b,q]}),l})()},3378:(w,A,p)=>{p.d(A,{m:()=>o});var c=p(9862),v=p(9212);let o=(()=>{var h;class g{constructor(t){this.http=t,this.urlApi="https://www.inspectionsquad.com/api/",this.urlApiReport="https://www.inspectionsquad.com/report/index.php"}getInspectionstAll(){return this.http.get(this.urlApi+"Inspections/getAll")}getAsignmentAll(){return this.http.get(this.urlApi+"Assignment/getAll")}getAssigmentById(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Assignment/getById",t,s)}getLogin(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Usuarios/login",t,s)}getObservationSection(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Observation/getByIdFather",t,s)}getObservation(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Observation/getObservation",t,s)}getObservationChild(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Observation/getObservationChild",t,s)}saveAssing(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Assignment/save",t,s)}delAssing(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Assignment/delete",t,s)}saveInspection(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/save",t,s)}saveInspectionDetails(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/saveDetails",t,s)}getInspectionsByStatusAndId(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/getInspectionsByStatusAndId",t,s)}getInspectionsByStatus(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/getInspectionsByStatus",t,s)}getInspectors(){return this.http.get(this.urlApi+"Inspectors/getAll")}delInspector(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspectors/delete",t,s)}saveInspector(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspectors/save",t,s)}getInspectionById(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/getInspectionById",t,s)}getDetailsInspection(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/getDetailsInspection",t,s)}setUpdateStatus(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/setUpdateStatus",t,s)}saveImage(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/saveImage",t,s)}getPhotos(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/getPhotos",t,s)}delPhoto(t){const s={headers:new c.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/delImage",t,s)}generateReport(t){return this.http.get(this.urlApiReport+"?id="+t)}}return(h=g).\u0275fac=function(t){return new(t||h)(v.LFG(c.eN))},h.\u0275prov=v.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),g})()}}]);