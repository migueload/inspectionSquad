"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7888],{7888:(O,_,l)=>{l.r(_),l.d(_,{AssingPageModule:()=>q});var r=l(6814),A=l(95),i=l(1929),u=l(1147),g=l(5861),n=l(5619),t=l(9212),w=l(3378),x=l(7346);const S=["addressSelect"];function E(a,h){if(1&a&&(t.TgZ(0,"ion-select-option",24),t._uU(1),t.qZA()),2&a){const e=h.$implicit;t.s9C("value",e.code),t.xp6(1),t.hij(" ",e.description," ")}}function P(a,h){if(1&a&&(t.TgZ(0,"ion-select-option",24),t._uU(1),t.qZA()),2&a){const e=h.$implicit;t.s9C("value",e.id),t.xp6(1),t.AsE(" ",e.name," ",e.last_name," ")}}function U(a,h){if(1&a&&(t.TgZ(0,"ion-item")(1,"ion-select",25),t.YNc(2,P,2,3,"ion-select-option",9),t.qZA()()),2&a){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.inspectors)}}function M(a,h){if(1&a){const e=t.EpF();t.TgZ(0,"ion-item",27),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw(2);return t.KtG(d.setAddress(c))}),t._UZ(1,"ion-icon",28),t.TgZ(2,"ion-label"),t._uU(3),t.TgZ(4,"p")(5,"ion-text"),t._uU(6),t.qZA()()()()}if(2&a){const e=h.$implicit;t.xp6(3),t.hij(" ",null==e?null:e.title," "),t.xp6(3),t.hij(" ",null==e?null:e.address," ")}}function j(a,h){if(1&a&&(t.TgZ(0,"ion-list"),t.YNc(1,M,7,2,"ion-item",26),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.places)}}function B(a,h){if(1&a){const e=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-card")(3,"div",29)(4,"ion-icon",30),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.showConfirmation(c.id))}),t.qZA()(),t.TgZ(5,"ion-card-header")(6,"ion-card-subtitle")(7,"b"),t._uU(8,"Date:"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"ion-card-subtitle"),t._uU(11),t.qZA(),t.TgZ(12,"ion-card-title"),t._uU(13),t.qZA()(),t.TgZ(14,"ion-card-content"),t._uU(15),t.qZA()()()()}if(2&a){const e=h.$implicit;t.xp6(9),t.hij(" ",e.date,""),t.xp6(2),t.AsE("",e.id_inspection," - ",e.description_inspection,""),t.xp6(2),t.Oqu(e.name_emp),t.xp6(2),t.hij(" ",e.address_emp," ")}}let I=(()=>{class a{get search_places(){return this._places.asObservable()}constructor(e,s,o,c,d,p){this.service=e,this.zone=s,this.alert=o,this.toast=c,this.navCtrl=d,this.actionSheetCtrl=p,this.places=[],this._places=new n.X([]),this.swAdmin=!1,this.isActionSheetOpen=!1}ngOnInit(){this.user=localStorage.getItem("username"),this.nivel=localStorage.getItem("nivel"),this.swAdmin="1"==this.nivel,this.loadTypeInspection(),this.loadInspectors(),"1"==this.nivel?this.loadAssigmentAll():this.loadAssigment(),this.placesSub=this.search_places.subscribe({next:e=>{this.places=e},error:e=>{console.log(e)}})}loadAssigment(){const s={id:localStorage.getItem("id_inspector")};this.service.getAssigmentById(s).subscribe(o=>{this.datos=o,console.log(this.datos)},o=>{console.error("Error al obtener los datos",o)})}loadAssigmentAll(){this.service.getAsignmentAll().subscribe(e=>{this.datos=e},e=>{console.error("Error al obtener los datos",e)})}loadTypeInspection(){this.service.getInspectionstAll().subscribe(e=>{this.types=e},e=>{console.log("Error"+e)})}loadInspectors(){this.service.getInspectors().subscribe(e=>{this.inspectors=e},e=>{console.log("Error"+e)})}onSearchChange(e){var s=this;return(0,g.Z)(function*(){console.log(e),s.query=e.detail.value,s.query.length>0&&(yield s.getPlaces())})()}getPlaces(){var e=this;return(0,g.Z)(function*(){try{(new google.maps.places.AutocompleteService).getPlacePredictions({input:e.query},o=>{let c=[];e.zone.run(()=>{null!=o&&(o.forEach(function(){var d=(0,g.Z)(function*(p){console.log("prediction: ",p);let f=yield e.geoCode(p.description);c.push({title:p.structured_formatting.main_text,address:p.description,lat:f.lat,lng:f.lng})});return function(p){return d.apply(this,arguments)}}()),e._places.next(c))})})}catch(s){console.log(s)}})()}geoCode(e){let s={lat:"",lng:""};return new Promise((o,c)=>{(new google.maps.Geocoder).geocode({address:e},p=>{console.log("results: ",p),s.lat=p[0].geometry.location.lat(),s.lng=p[0].geometry.location.lng(),o(s)})})}ngOnDestroy(){this.placesSub&&this.placesSub.unsubscribe()}setAddress(e){this.addressSelect.nativeElement.value=e.address,this.places=[]}save(){const e=document.getElementById("name"),s=document.getElementById("date"),o=document.getElementById("type"),c=document.getElementById("idiom"),d=document.getElementById("address"),p=document.getElementById("inspector"),f=c.value,v=s.value,Z=e.value,b=o.value,k=d.value;let y=localStorage.getItem("id_inspector");this.swAdmin&&(y=p.value,localStorage.setItem("id_inspector",y));let m="";if(""==v&&(m="Date, "),""==Z&&(m+="Establishment name, "),null==b&&(m+="Type of inspection, "),this.campos=m,""!=m)this.validarVacio();else{const T={date:v,idiom:f,name_emp:Z,address_emp:k,id_inspector:y,id_inspection:b};console.log(T),this.service.saveAssing(T).subscribe(C=>{this.clearFields(),this.success(),"1"==this.nivel?this.loadAssigmentAll():this.loadAssigment()},C=>{console.log("Error"+C)})}}clearFields(){const e=document.getElementById("name"),s=document.getElementById("date"),o=document.getElementById("type");document.getElementById("address").value="",e.value="",o.value="",s.value=""}back(){this.navCtrl.navigateForward("dashboard")}showConfirmation(e){var s=this;return(0,g.Z)(function*(){yield(yield s.alert.create({header:"Confirmation",message:"\xbfAre you sure?",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Acci\xf3n cancelada")}},{text:"Ok",handler:()=>{s.delAssing(e)}}]})).present()})()}delAssing(e){this.service.delAssing({id:e}).subscribe(o=>{this.loadAssigment()},o=>{console.log("Error"+o)})}closeSesion(){localStorage.clear(),this.navCtrl.navigateForward("")}validarVacio(){var e=this;return(0,g.Z)(function*(){(yield e.toast.create({message:"("+e.campos+") Fields are required",duration:3e3,position:"middle"})).present()})()}success(){var e=this;return(0,g.Z)(function*(){(yield e.toast.create({message:"The assignment was saved successfully.",duration:3e3,position:"middle"})).present()})()}delete(){var e=this;return(0,g.Z)(function*(){(yield e.toast.create({message:"The assignment has been removed.",duration:2e3,position:"middle"})).present()})()}presentActionSheet(){var e=this;return(0,g.Z)(function*(){yield(yield e.actionSheetCtrl.create({header:"Actions",buttons:[{text:"Are you sure you log out?",role:"exit",handler:()=>{e.closeSesion()}},{text:"Cancel",role:"cancel",data:{action:"cancel"}}]})).present()})()}static#t=this.\u0275fac=function(s){return new(s||a)(t.Y36(w.m),t.Y36(t.R0b),t.Y36(i.Br),t.Y36(i.yF),t.Y36(x.SH),t.Y36(i.BX))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-assing"]],viewQuery:function(s,o){if(1&s&&t.Gf(S,5),2&s){let c;t.iGM(c=t.CRH())&&(o.addressSelect=c.first)}},standalone:!0,features:[t.jDz],decls:53,vars:6,consts:[[3,"translucent"],["src","../../assets/img/logo_circle.png","alt","Logo Inspection squad",2,"width","50px"],[1,"user",2,"text-align","right",3,"click"],[2,"color","#6E6E6E"],["name","person"],[2,"text-align","left","margin-left","20px"],[1,"titulo"],["type","date","id","date","label","Select Date"],["label","Select type of inspection","id","type"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["value","spa","id","idiom"],["value","spa"],["value","eng"],["label","Establishment Name","id","name"],["type","text","id","address","placeholder","Establishment Address","disabled","",2,"background-color","#fff","color","#6E6E6E","width","100%","height","35px"],["addressSelect",""],["searchIcon","search-circle","animated","true","showClearButton","focus","clearIcon","trash-bin","debounce","800","placeholder","Search for area, street...",3,"ionInput"],[2,"margin-top","50px","margin-left","20px","padding-right","20px","margin-bottom","20px"],["fill","clear","expand","full",2,"background-color","#1c345c","color","#fff",3,"click"],["name","checkmark-outline"],[4,"ngFor","ngForOf"],["fill","default","expand","full",2,"background-color","#fff","color","#000",3,"click"],["name","chevron-back-outline"],[3,"value"],["label","Select inspectors","id","inspector"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["name","location-outline","slot","start"],[2,"text-align","right"],["name","close-circle-outline",2,"color","#b11c44","font-size","18px",3,"click"]],template:function(s,o){1&s&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar"),t._UZ(2,"ion-img",1),t.TgZ(3,"div",2),t.NdJ("click",function(){return o.presentActionSheet()}),t.TgZ(4,"ion-label",3),t._uU(5),t._UZ(6,"ion-icon",4),t.qZA()()()(),t.TgZ(7,"ion-content"),t._UZ(8,"br"),t.TgZ(9,"div",5)(10,"ion-label",6),t._uU(11,"ASSING"),t.qZA()(),t._UZ(12,"br"),t.TgZ(13,"ion-list")(14,"ion-item"),t._UZ(15,"ion-input",7),t.qZA(),t._UZ(16,"br"),t.TgZ(17,"ion-item")(18,"ion-select",8),t.YNc(19,E,2,2,"ion-select-option",9),t.qZA()(),t._UZ(20,"br"),t.YNc(21,U,3,1,"ion-item",10),t._UZ(22,"br"),t.TgZ(23,"ion-item")(24,"ion-label"),t._uU(25," Select the language of the inspection report "),t.qZA(),t.TgZ(26,"ion-segment",11)(27,"ion-segment-button",12)(28,"ion-label"),t._uU(29,"Spanish"),t.qZA()(),t.TgZ(30,"ion-segment-button",13)(31,"ion-label"),t._uU(32,"English"),t.qZA()()()(),t._UZ(33,"br"),t.TgZ(34,"ion-item"),t._UZ(35,"ion-input",14),t.qZA(),t.TgZ(36,"ion-item"),t._UZ(37,"input",15,16),t.qZA(),t._UZ(39,"br"),t.TgZ(40,"ion-item")(41,"ion-searchbar",17),t.NdJ("ionInput",function(d){return o.onSearchChange(d)}),t.qZA()()(),t.YNc(42,j,2,1,"ion-list",10),t.TgZ(43,"div",18)(44,"ion-button",19),t.NdJ("click",function(){return o.save()}),t._UZ(45,"ion-icon",20),t._uU(46,"Save"),t.qZA()(),t.TgZ(47,"ion-grid"),t.YNc(48,B,16,5,"ion-row",21),t.qZA()(),t.TgZ(49,"ion-footer")(50,"ion-button",22),t.NdJ("click",function(){return o.back()}),t._UZ(51,"ion-icon",23),t._uU(52,"Back"),t.qZA()()),2&s&&(t.Q6J("translucent",!0),t.xp6(5),t.hij("",o.user," "),t.xp6(14),t.Q6J("ngForOf",o.types),t.xp6(2),t.Q6J("ngIf",o.swAdmin),t.xp6(21),t.Q6J("ngIf",(null==o.places?null:o.places.length)>0),t.xp6(6),t.Q6J("ngForOf",o.datos))},dependencies:[i.Pc,i.YG,i.PM,i.FN,i.Zi,i.tO,i.Dq,i.wI,i.W2,i.fr,i.jY,i.Gu,i.gu,i.Xz,i.pK,i.Ie,i.Q$,i.q_,i.Nd,i.VI,i.cJ,i.GO,i.t9,i.n0,i.yW,i.sr,i.QI,i.j9,r.ez,r.sg,r.O5],styles:[".ios[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{padding:8px 12px}.ios[_ngcontent-%COMP%]   #address[_ngcontent-%COMP%]{width:100%;border-color:solid;border-style:none}ion-card-title[_ngcontent-%COMP%]{font-size:20px}"]})}return a})();const F=[{path:"",component:I}];let W=(()=>{class a{static#t=this.\u0275fac=function(s){return new(s||a)};static#e=this.\u0275mod=t.oAB({type:a});static#n=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(F),u.Bz]})}return a})(),q=(()=>{class a{static#t=this.\u0275fac=function(s){return new(s||a)};static#e=this.\u0275mod=t.oAB({type:a});static#n=this.\u0275inj=t.cJS({imports:[r.ez,A.u5,i.Pc,I,W]})}return a})()},3378:(O,_,l)=>{l.d(_,{m:()=>i});var r=l(9862),A=l(9212);let i=(()=>{class u{constructor(n){this.http=n,this.urlApi="https://www.inspectionsquad.com/api/",this.urlApiReport="https://www.inspectionsquad.com/report/index.php"}getInspectionstAll(){return this.http.get(this.urlApi+"Inspections/getAll")}getAsignmentAll(){return this.http.get(this.urlApi+"Assignment/getAll")}getAssigmentById(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Assignment/getById",n,t)}getLogin(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Usuarios/login",n,t)}getObservationSection(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Observation/getByIdFather",n,t)}getObservation(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Observation/getObservation",n,t)}getObservationChild(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Observation/getObservationChild",n,t)}saveAssing(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Assignment/save",n,t)}delAssing(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Assignment/delete",n,t)}saveInspection(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/save",n,t)}saveInspectionDetails(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/saveDetails",n,t)}getInspectionsByStatusAndId(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/getInspectionsByStatusAndId",n,t)}getInspectionsByStatus(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/getInspectionsByStatus",n,t)}getInspectors(){return this.http.get(this.urlApi+"Inspectors/getAll")}delInspector(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspectors/delete",n,t)}saveInspector(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspectors/save",n,t)}getInspectionById(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/getInspectionById",n,t)}getDetailsInspection(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/getDetailsInspection",n,t)}setUpdateStatus(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/setUpdateStatus",n,t)}saveImage(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/saveImage",n,t)}getPhotos(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/getPhotos",n,t)}delPhoto(n){const t={headers:new r.WM({"Content-Type":"application/json"})};return this.http.post(this.urlApi+"Inspections/delImage",n,t)}generateReport(n){return this.http.get(this.urlApiReport+"?id="+n)}static#t=this.\u0275fac=function(t){return new(t||u)(A.LFG(r.eN))};static#e=this.\u0275prov=A.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()}}]);